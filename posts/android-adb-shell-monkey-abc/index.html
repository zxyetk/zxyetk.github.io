<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.80.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Monkey 是一个在模拟器或设备上运行的程序，可生成伪随机用户事件（例如点击、轻触或手势）流以及很多系统级事件。您可以使用 Monkey 以随机且可重复的方式对正在开发的应用进行压力测试。
概览 #  Monkey 是一个命令行工具，可以在任何模拟器实例或设备上运行。它会将伪随机用户事件流发送到系统中，从而在您正在开发的应用软件上进行压力测试。
Monkey 包含许多选项，主要分为以下四个类别：
 基本配置选项，例如设置要尝试的事件数。 操作限制条件，例如将测试对象限制为单个软件包。 事件类型和频率。 调试选项。  Monkey 在运行时会生成事件并将其发送到系统。它还会监视被测系统并查找三种特殊情况：
 如果您已将 Monkey 限制为在一个或多个特定软件包中运行，它会监视转到任何其他软件包的尝试并阻止它们。 如果应用崩溃或收到任何未处理的异常，Monkey 会停止并报告错误。 如果应用生成“应用无响应”错误，Monkey 会停止并报告错误。  根据您选择的详细程度级别，您还将看到有关 Monkey 进度和所生成事件的报告。
Monkey 的基本用法 #  您可以使用开发计算机上的命令行启动 Monkey，也可以通过脚本启动。由于 Monkey 在模拟器/设备环境中运行，因此您必须从该环境中通过 shell 启动它。为此，您可以在每个命令前面加上 adb shell，或者直接进入 shell 并输入 Monkey 命令。
基本语法如下：
$ adb shell monkey [options] <event-count> 如果未指定任何选项，Monkey 将以静默（非详细）模式启动，并将事件发送到目标上安装的任何（及所有）软件包。下面是一个更典型的命令行，它会启动您的应用并向其发送 500 个伪随机事件：
$ adb shell monkey -p your.package.name -v 500 命令选项参考 #  下表列出了您可以在 Monkey 命令行中添加的所有选项。"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Android随机测试工具Monkey简介"><meta property="og:description" content="Monkey 是一个在模拟器或设备上运行的程序，可生成伪随机用户事件（例如点击、轻触或手势）流以及很多系统级事件。您可以使用 Monkey 以随机且可重复的方式对正在开发的应用进行压力测试。
概览 #  Monkey 是一个命令行工具，可以在任何模拟器实例或设备上运行。它会将伪随机用户事件流发送到系统中，从而在您正在开发的应用软件上进行压力测试。
Monkey 包含许多选项，主要分为以下四个类别：
 基本配置选项，例如设置要尝试的事件数。 操作限制条件，例如将测试对象限制为单个软件包。 事件类型和频率。 调试选项。  Monkey 在运行时会生成事件并将其发送到系统。它还会监视被测系统并查找三种特殊情况：
 如果您已将 Monkey 限制为在一个或多个特定软件包中运行，它会监视转到任何其他软件包的尝试并阻止它们。 如果应用崩溃或收到任何未处理的异常，Monkey 会停止并报告错误。 如果应用生成“应用无响应”错误，Monkey 会停止并报告错误。  根据您选择的详细程度级别，您还将看到有关 Monkey 进度和所生成事件的报告。
Monkey 的基本用法 #  您可以使用开发计算机上的命令行启动 Monkey，也可以通过脚本启动。由于 Monkey 在模拟器/设备环境中运行，因此您必须从该环境中通过 shell 启动它。为此，您可以在每个命令前面加上 adb shell，或者直接进入 shell 并输入 Monkey 命令。
基本语法如下：
$ adb shell monkey [options] <event-count> 如果未指定任何选项，Monkey 将以静默（非详细）模式启动，并将事件发送到目标上安装的任何（及所有）软件包。下面是一个更典型的命令行，它会启动您的应用并向其发送 500 个伪随机事件：
$ adb shell monkey -p your.package.name -v 500 命令选项参考 #  下表列出了您可以在 Monkey 命令行中添加的所有选项。"><meta property="og:type" content="article"><meta property="og:url" content="https://zxye.tk/posts/android-adb-shell-monkey-abc/"><meta property="article:published_time" content="2019-12-23T16:11:14+00:00"><meta property="article:modified_time" content="2019-12-23T16:11:14+00:00"><title>Android随机测试工具Monkey简介 | 仲夏叶 | 科技</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.134b70e5316650a530cb42e4e8630b2a01d532bebfc0337028211175336e4806.css integrity="sha256-E0tw5TFmUKUwy0Lk6GMLKgHVMr6/wDNwKCERdTNuSAY="><script defer src=/en.search.min.3fad425eb896bf605587c421cf613958456e6b1975e759c6731356bfe51de792.js integrity="sha256-P61CXriWv2BVh8Qhz2E5WEVuaxl151nGcxNWv+Ud55I="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>仲夏叶 | 科技</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Android随机测试工具Monkey简介</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#monkey-的基本用法>Monkey 的基本用法</a></li><li><a href=#命令选项参考>命令选项参考</a></li></ul></nav></aside></header><article class=markdown><h1><a href=/posts/android-adb-shell-monkey-abc/>Android随机测试工具Monkey简介</a></h1><h5>December 23, 2019</h5><div><a href=/categories/testing/>testing</a></div><div><a href=/tags/android/>android</a>,
<a href=/tags/monkey/>monkey</a></div><p><p>Monkey 是一个在<a href=https://developer.android.com/tools/help/emulator.html>模拟器</a>或设备上运行的程序，可生成伪随机用户事件（例如点击、轻触或手势）流以及很多系统级事件。您可以使用 Monkey 以随机且可重复的方式对正在开发的应用进行压力测试。</p><h1 id=概览>概览
<a class=anchor href=#%e6%a6%82%e8%a7%88>#</a></h1><p>Monkey 是一个命令行工具，可以在任何模拟器实例或设备上运行。它会将伪随机用户事件流发送到系统中，从而在您正在开发的应用软件上进行压力测试。</p><p>Monkey 包含许多选项，主要分为以下四个类别：</p><ul><li>基本配置选项，例如设置要尝试的事件数。</li><li>操作限制条件，例如将测试对象限制为单个软件包。</li><li>事件类型和频率。</li><li>调试选项。</li></ul><p>Monkey 在运行时会生成事件并将其发送到系统。它还会监视被测系统并查找三种特殊情况：</p><ul><li>如果您已将 Monkey 限制为在一个或多个特定软件包中运行，它会监视转到任何其他软件包的尝试并阻止它们。</li><li>如果应用崩溃或收到任何未处理的异常，Monkey 会停止并报告错误。</li><li>如果应用生成“应用无响应”错误，Monkey 会停止并报告错误。</li></ul><p>根据您选择的详细程度级别，您还将看到有关 Monkey 进度和所生成事件的报告。</p><h2 id=monkey-的基本用法>Monkey 的基本用法
<a class=anchor href=#monkey-%e7%9a%84%e5%9f%ba%e6%9c%ac%e7%94%a8%e6%b3%95>#</a></h2><p>您可以使用开发计算机上的命令行启动 Monkey，也可以通过脚本启动。由于 Monkey 在模拟器/设备环境中运行，因此您必须从该环境中通过 shell 启动它。为此，您可以在每个命令前面加上 <code>adb shell</code>，或者直接进入 shell 并输入 Monkey 命令。</p><p>基本语法如下：</p><pre><code>$ adb shell monkey [options] &lt;event-count&gt;
</code></pre><p>如果未指定任何选项，Monkey 将以静默（非详细）模式启动，并将事件发送到目标上安装的任何（及所有）软件包。下面是一个更典型的命令行，它会启动您的应用并向其发送 500 个伪随机事件：</p><pre><code>$ adb shell monkey -p your.package.name -v 500
</code></pre><h2 id=命令选项参考>命令选项参考
<a class=anchor href=#%e5%91%bd%e4%bb%a4%e9%80%89%e9%a1%b9%e5%8f%82%e8%80%83>#</a></h2><p>下表列出了您可以在 Monkey 命令行中添加的所有选项。</p><table><thead><tr><th style=text-align:left>类别</th><th style=text-align:left>选项</th><th style=text-align:left>说明</th></tr></thead><tbody><tr><td style=text-align:left>常规</td><td style=text-align:left><code>--help</code></td><td style=text-align:left>输出简单的使用指南。</td></tr><tr><td style=text-align:left><code>-v</code></td><td style=text-align:left>命令行上的每个 -v 都会增加详细程度级别。级别 0（默认值）只提供启动通知、测试完成和最终结果。级别 1 提供有关测试在运行时（例如发送到您的 Activity 的各个事件）的更多详细信息。级别 2 提供更详细的设置信息，例如已选择或未选择用于测试的 Activity。</td><td style=text-align:left></td></tr><tr><td style=text-align:left>事件</td><td style=text-align:left><code>-s</code></td><td style=text-align:left>伪随机数生成器的种子值。如果您使用相同的种子值重新运行 Monkey，它将会生成相同的事件序列。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--throttle</code></td><td style=text-align:left>在事件之间插入固定的延迟时间。您可以使用此选项减慢 Monkey 速度。如果未指定，则没有延迟，系统会尽快地生成事件。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--pct-touch</code></td><td style=text-align:left>调整轻触事件所占百分比。（轻触事件是指屏幕上的单个位置上的按下/释放事件。）</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--pct-motion</code></td><td style=text-align:left>调整动作事件所占百分比。（动作事件包括屏幕上某个位置的按下事件，一系列伪随机动作和一个释放事件。）</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--pct-trackball</code></td><td style=text-align:left>调整轨迹球事件所占百分比。（轨迹球事件包括一个或多个随机动作，有时后跟点击。）</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--pct-nav</code></td><td style=text-align:left>调整“基本”导航事件所占百分比。（导航事件包括向上/向下/向左/向右，作为方向输入设备的输入。）</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--pct-majornav</code></td><td style=text-align:left>调整“主要”导航事件所占百分比。（这些导航事件通常会导致界面中的操作，例如 5 方向键的中间按钮、返回键或菜单键。）</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--pct-syskeys</code></td><td style=text-align:left>调整“系统”按键事件所占百分比。（这些按键通常预留供系统使用，例如“主屏幕”、“返回”、“发起通话”、“结束通话”或“音量控件”。）</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--pct-appswitch</code></td><td style=text-align:left>调整 Activity 启动次数所占百分比。Monkey 会以随机间隔发起 startActivity() 调用，以最大限度地覆盖软件包中的所有 Activity。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--pct-anyevent</code></td><td style=text-align:left>调整其他类型事件所占百分比。这包括所有其他类型的事件，例如按键、设备上的其他不太常用的按钮等等。</td></tr><tr><td style=text-align:left>约束</td><td style=text-align:left><code>-p</code></td><td style=text-align:left>如果您通过这种方式指定一个或多个软件包，Monkey 将仅允许系统访问这些软件包内的 Activity。如果应用需要访问其他软件包中的 Activity（例如选择联系人），您还需要指定这些软件包。如果您未指定任何软件包，Monkey 将允许系统启动所有软件包中的 Activity。要指定多个软件包，请多次使用 -p 选项 - 每个软件包对应一个 -p 选项。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>-c</code></td><td style=text-align:left>如果您通过这种方式指定一个或多个类别，Monkey 将仅允许系统访问其中一个指定类别中所列的 Activity。如果您没有指定任何类别，Monkey 会选择 Intent.CATEGORY_LAUNCHER 或 Intent.CATEGORY_MONKEY 类别所列的 Activity。要指定多个类别，请多次使用 -c 选项 - 每个类别对应一个 -c 选项。</td></tr><tr><td style=text-align:left>调试</td><td style=text-align:left><code>--dbg-no-events</code></td><td style=text-align:left>指定后，Monkey 将初始启动到测试 Activity，但不会生成任何其他事件。为了获得最佳结果，请结合使用 -v、一个或多个软件包约束条件以及非零限制，以使 Monkey 运行 30 秒或更长时间。这提供了一个环境，您可以在其中监控应用调用的软件包转换操作。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--hprof</code></td><td style=text-align:left>如果设置此选项，此选项将在 Monkey 事件序列之前和之后立即生成分析报告。这将在 data/misc 下生成大型（约为 5Mb）文件，因此请谨慎使用。要了解如何分析性能分析报告，请参阅<a href=https://developer.android.com/studio/profile>分析应用性能</a>。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--ignore-crashes</code></td><td style=text-align:left>通常，当应用崩溃或遇到任何类型的未处理异常时，Monkey 将会停止。如果您指定此选项，Monkey 会继续向系统发送事件，直到计数完成为止。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--ignore-timeouts</code></td><td style=text-align:left>通常情况下，如果应用遇到任何类型的超时错误（例如“应用无响应”对话框），Monkey 将会停止。如果您指定此选项，Monkey 会继续向系统发送事件，直到计数完成为止。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--ignore-security-exceptions</code></td><td style=text-align:left>通常情况下，如果应用遇到任何类型的权限错误（例如，如果它尝试启动需要特定权限的 Activity），Monkey 将会停止。如果您指定此选项，Monkey 会继续向系统发送事件，直到计数完成为止。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--kill-process-after-error</code></td><td style=text-align:left>通常情况下，当 Monkey 因出错而停止运行时，出现故障的应用将保持运行状态。设置此选项后，它将会指示系统停止发生错误的进程。注意，在正常（成功）完成情况下，已启动的进程不会停止，并且设备仅会处于最终事件之后的最后状态。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--monitor-native-crashes</code></td><td style=text-align:left>监视并报告 Android 系统原生代码中发生的崩溃。如果设置了 &ndash;kill-process-after-error，系统将会停止。</td></tr><tr><td style=text-align:left></td><td style=text-align:left><code>--wait-dbg</code></td><td style=text-align:left>阻止 Monkey 执行，直到为其连接了调试程序。</td></tr></tbody></table><p><strong>来源</strong></p><blockquote><p><a href=https://developer.android.com/studio/test/monkey>UI/Application Exerciser Monkey</a></p></blockquote></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#monkey-的基本用法>Monkey 的基本用法</a></li><li><a href=#命令选项参考>命令选项参考</a></li></ul></nav></aside></main></body></html>